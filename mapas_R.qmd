---
title: "Produzindo mapas com R"
author: "Jeanne Franco"
format: html 
# format: pdf
date: 05/04/24
categories: [Códigos, R base, Mapas]
lang: pt
toc: true
---

Nesta seção explicarei como produzir mapas no R e quais pacotes são necessários para essa finalidade. Como exemplo, irei elaborar um mapa dos biomas brasileiros, incluindo a legenda, orientação, eixos e escala.

## Pacotes necessários

```{r echo=TRUE, eval=FALSE, warning=FALSE,message=FALSE, cache=TRUE}

library(sf) # Permite ler arquivos shapefile
library(ggspatial) # Adicionar símbolo de orientação e escala
library(tidyverse) # Produzir mapa com ggplot2
library(cols4all) # Selecionar cores do mapa
```

## Carregar arquivos shapefile em seu computador

Os dados foram retirados do site do [IBGE](https://www.ibge.gov.br/). Para acessar os arquivos, você deve acessar o site, ir na aba de seleção à esquerda e fazer as seguintes etapas para baixar os dados dos biomas brasileiros:

```{mermaid}
    flowchart LR

      id1(Geociências) --> id2(Cartas e Mapas)
      id2(Cartas e Mapas) --> id3(Brasil: Informações ambientais)
      id3(Brasil: Informações ambientais) --> id4(Vetores)
      id4(Vetores) --> id5(Downloads - na aba esquerda)
      id5(Downloads - na aba esquerda) --> id6(Vetores)
      id6(Vetores) --> id7(Biomas_250mil)
      
      style id1 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id2 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id3 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id4 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id5 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id6 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id7 fill:#98D8AA,stroke:#333,stroke-width:3px
```

Após carregar os arquivos em sua pasta do diretório de trabalho, você também deve baixar os arquivos com os dados das regiões (Norte, Nordeste, Centro-Oeste, Sudeste e Sul) do Brasil. Para isso, faça as seguintes seleções:

```{mermaid}
    flowchart LR

      id1(Geociências) --> id2(Organização do território)
      id2(Organização do território) --> id3(Malhas territoriais)
      id3(Malhas territoriais) --> id4(Malha Municipal)
      id4(Malha Municipal) --> id5(Brasil)
      id5(Brasil) --> id6(Link Unidades da Federação)
      
      style id1 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id2 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id3 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id4 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id5 fill:#98D8AA,stroke:#333,stroke-width:3px
      style id6 fill:#98D8AA,stroke:#333,stroke-width:3px
```

Da mesma forma, salve todos os arquivos em uma mesma pasta.

## Carregar dados no R

Você deve usar a função `read_sf()` para fazer a leitura dos arquivos. Após isso, use a função `view()` para visualizar a tabela com todos os dados.

Você também pode usar a função `st_geometry()` com a função `plot()` para visualizar o mapa inicial.

```{r}

#| echo: true
#| warning: false
#| message: false
#| cache: true


## Dados biomas

my_biom <- read_sf("lm_bioma_250.shp") 
view(my_biom)
plot(st_geometry(my_biom))

## Dados regiões do Brasil

my_br <- read_sf("BR_UF_2022.shp") 
view(my_br)
plot(st_geometry(my_br))
```

## Produzir mapa

Selecionar cores com o pacote `cols4all`:

``` r
## Selecionar cores

c4a_table(n = 12, type = "cat") # Seleciona 6 cores do tipo categórica
c4a_types()
```
